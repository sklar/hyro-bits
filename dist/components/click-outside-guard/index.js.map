{"version":3,"sources":["../../../src/components/click-outside-guard/index.ts","../../../src/components/click-outside-guard/click-outside-guard.tsx"],"sourcesContent":["export { ClickOutsideGuard } from './click-outside-guard';\nexport type { ClickOutsideGuardProps } from './click-outside-guard';\n","import styled from '@emotion/styled';\nimport { useCombinedRef } from '@spicy-hooks/core';\nimport React, { forwardRef, HTMLAttributes, useEffect, useRef } from 'react';\n\nexport interface ClickOutsideGuardProps extends HTMLAttributes<HTMLDivElement> {\n  ignore?: Element;\n  listen?: boolean;\n  onClickOutside: () => void;\n}\n\n/**\n * Click outside guard\n * @see https://css-tricks.com/click-outside-detector/\n */\nexport const ClickOutsideGuard = forwardRef<HTMLDivElement, ClickOutsideGuardProps>(\n  ({ ignore, listen, onClickOutside, ...props }, ref) => {\n    const innerRef = useRef<HTMLDivElement>(null);\n    const combinedRef = useCombinedRef(ref, innerRef);\n\n    const onKeyUp = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') onClickOutside();\n      handleEvent(event);\n    };\n\n    const handleEvent = (event: Event) => {\n      if (innerRef.current && innerRef.current.contains(event.target as Node)) return;\n      if (ignore && ignore.contains && ignore.contains(event.target as Node)) {\n        return;\n      }\n      onClickOutside();\n    };\n\n    useEffect(() => {\n      if (listen && onClickOutside) {\n        document.addEventListener('mousedown', handleEvent, false);\n        document.addEventListener('touchend', handleEvent, false);\n        document.addEventListener('keyup', onKeyUp);\n\n        return () => {\n          document.removeEventListener('mousedown', handleEvent, false);\n          document.removeEventListener('touchend', handleEvent, false);\n          document.removeEventListener('keyup', onKeyUp);\n        };\n      }\n    });\n\n    return <Container ref={combinedRef} {...props} />;\n  }\n);\n\nconst Container = styled.div`\n  display: contents;\n`;\n"],"mappings":";smCAAA,wCCAA,MAAmB,8BACnB,EAA+B,6BAC/B,EAAqE,oBAYxD,EAAoB,iBAC/B,CAAC,EAA8C,IAAQ,CAAtD,QAAE,UAAQ,SAAQ,kBAAlB,EAAqC,IAArC,EAAqC,CAAnC,SAAQ,SAAQ,mBACjB,GAAM,GAAW,aAAuB,MAClC,EAAc,qBAAe,EAAK,GAElC,EAAU,AAAC,GAAyB,CACxC,AAAI,EAAM,MAAQ,UAAU,IAC5B,EAAY,IAGR,EAAc,AAAC,GAAiB,CACpC,AAAI,EAAS,SAAW,EAAS,QAAQ,SAAS,EAAM,SACpD,GAAU,EAAO,UAAY,EAAO,SAAS,EAAM,SAGvD,KAGF,sBAAU,IAAM,CACd,GAAI,GAAU,EACZ,gBAAS,iBAAiB,YAAa,EAAa,IACpD,SAAS,iBAAiB,WAAY,EAAa,IACnD,SAAS,iBAAiB,QAAS,GAE5B,IAAM,CACX,SAAS,oBAAoB,YAAa,EAAa,IACvD,SAAS,oBAAoB,WAAY,EAAa,IACtD,SAAS,oBAAoB,QAAS,MAKrC,wBAAC,EAAD,GAAW,IAAK,GAAiB,MAItC,EAAY,UAAO;AAAA;","names":[]}